FROM quay.io/centos/centos:stream10

LABEL maintainer="HPC Team"
LABEL description="Flux MCP Server - Model Context Protocol server for Flux Framework"

# Install Python and dependencies
RUN dnf install -y \
    python3.12 \
    python3-pip \
    && dnf clean all

# Create app directory
WORKDIR /app

# Copy requirements and install Python packages
COPY requirements.txt /app/
RUN pip3 install --no-cache-dir -r requirements.txt

# Copy application files
COPY flux_client.py /app/
COPY flux_mcp_server.py /app/

# Make server executable
RUN chmod +x /app/flux_mcp_server.py

# Set environment variables
ENV PYTHONUNBUFFERED=1
ENV FLUX_URI=local:///mnt/flux/view/run/flux/local
ENV FLUX_NAMESPACE=flux-operator
ENV FLUX_MINICLUSTER=flux-sample

# Run the MCP server
CMD ["python3", "/app/flux_mcp_server.py"]

