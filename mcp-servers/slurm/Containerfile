FROM quay.io/centos/centos:stream10

LABEL maintainer="HPC Team"
LABEL description="Slurm MCP Server - Model Context Protocol server for Slurm"

# Install Python and dependencies
RUN dnf install -y \
    python3.12 \
    python3-pip \
    && dnf clean all

# Create app directory
WORKDIR /app

# Copy requirements and install Python packages
COPY requirements.txt /app/
RUN pip3 install --no-cache-dir -r requirements.txt

# Copy application files
COPY slurm_client.py /app/
COPY slurm_mcp_server.py /app/

# Make server executable
RUN chmod +x /app/slurm_mcp_server.py

# Set environment variables
ENV PYTHONUNBUFFERED=1
ENV SLURM_REST_URL=http://slurm-restapi.slurm.svc.cluster.local:6820
ENV SLURM_USER=root
ENV SLURM_NAMESPACE=slurm

# Run the MCP server
CMD ["python3", "/app/slurm_mcp_server.py"]

